show databases;
CREATE DATABASE library;
use library;

# ======================= init =======================

DROP TABLE IF EXISTS 读者表;
DROP TABLE IF EXISTS 读者类型表;
DROP TABLE IF EXISTS 库存表;
DROP TABLE IF EXISTS 借阅表;

CREATE TABLE 读者表 (
   读者编号 VARCHAR(255),
   姓名 VARCHAR(255),
   类别号 int,
   单位 VARCHAR(255),
   有效性 VARCHAR(255)
);

INSERT INTO 读者表 (读者编号,姓名,类别号,单位,有效性)
VALUES
('0001', '张小东', 1, '软件学院', '有效'),
('0002', '苏明', 1, '财经学院', '有效'),
('1001', '梁小红', 2, '软件学院', '有效'),
('1002', '赵明敏', 2, '传媒学院', '有效'),
('2001', '李丰年', 3, '计财处', '有效');
ALTER TABLE 读者表 ADD PRIMARY KEY (读者编号);


CREATE TABLE 读者类型表 (
    类别号 Int,
    类名 varchar(255),
    可借数量 INT,
    可借天数 INT
);

ALTER TABLE 读者类型表 ADD PRIMARY KEY (类别号);

INSERT INTO 读者类型表 (类别号, 类名, 可借数量, 可借天数)
VALUES
(1, '学生', 10, 30),
(2, '教师', 20, 60),
(3, '职工', 15, 20);


CREATE TABLE 库存表 (
   条码 varchar(255),
   书号 varchar(255),
   位置 varchar(255),
   库存状态 varchar(255)
);

INSERT INTO 库存表 (条码,书号,位置,库存状态)
VALUES
('123412', 'A0120', '1-A-56', '在馆'),
('123413', 'A0120', '1-A-57', '借出'),
('223410', 'A0134', '2-B-01', '在馆'),
('223411', 'A0134', '2-B-02', '借出'),
('311231', 'B1101', '2-C-23', '在馆'),
('321123', 'C1269', '3-A-12', '丢失'),
('321124', 'C1269', '3-A-13', '借出'),
('411111', 'C3256', '3-B-01', '借出'),
('411112', 'C3256', '3-B-02', '借出'),
('411113', 'C3256', '3-B-03', '在馆');

CREATE TABLE 借阅表 (
 借阅号 varchar(255),
 条码 varchar(255),
 读者编号 varchar(255),
 借阅日期 varchar(255),
 还书日期 varchar(255),
 借阅状态 varchar(255)
);

INSERT INTO 借阅表 (借阅号,条码,读者编号,借阅日期,还书日期,借阅状态)
VALUES
('100001', '123413', '0001', '2020/11/5', '', '借阅'),
('100002', '223411', '0002', '2020/9/28', '2020/10/13',  '已还'),
('100003', '321123', '1001', '2020/7/1', '', '过期'),
('100004', '321124', '2001', '2020/10/9', '2020/10/14', '已还'),
('100005', '321124', '0001', '2020/10/15','', '借阅'),
('100006', '223411', '2001', '2020/10/16','', '借阅'),
('100007', '411111', '1002', '2020/9/1', '2020/9/24', '已还'),
('100008', '411111', '0001', '2020/9/25', '', '借阅'),
('100009', '411111', '1001', '2020/10/8', '', '借阅');


SHOW TABLES;